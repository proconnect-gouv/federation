import {
  USER_OPERATOR,
  USER_PASS,
} from '../../../../shared/cypress/support/constants';

describe('Data provider search', () => {
  const BASE_URL = Cypress.config('baseUrl');
  before(() => cy.resetEnv('mongo'));
  beforeEach(() => {
    cy.login(USER_OPERATOR, USER_PASS);
    cy.visit(`/data-provider?sort=active&action=desc`);
  });

  describe('Successful scenarios', () => {
    it('Should display a search result by name', () => {
      cy.formType('input[name=search]', 'Mock - 1');
      cy.get('#searchBtn').click();
      cy.url().should('eq', `${BASE_URL}/data-provider?search=Mock+-+1`);
      cy.contains('tbody > tr > th', `Fournisseur de données Mock - 1`);
      cy.get('tbody')
        .find('tr')
        .should('have.length', 1);
    });

    it('Should display a search result by name not case sensitive', () => {
      cy.formType('input[name=search]', 'mock - 2');
      cy.get('#searchBtn').click();
      cy.url().should('eq', `${BASE_URL}/data-provider?search=mock+-+2`);
      cy.contains('tbody > tr > th', `Fournisseur de données Mock - 2`);
      cy.get('tbody')
        .find('tr')
        .should('have.length', 1);
      });
      
      it('Should display a search result by client_id', () => {
        cy.formType(
          'input[name=search]',
          '423dcbdc5a15ece61ed00ff5989d72379c26d9ed4c8e4e05a87cffae019586e0',
        );
        cy.get('#searchBtn').click();
        cy.contains('tbody > tr > th', `Fournisseur de données Mock - 1`);
        cy.get('tbody')
          .find('tr')
          .should('have.length', 1);
      cy.url().should(
        'eq',
        `${BASE_URL}/data-provider?search=423dcbdc5a15ece61ed00ff5989d72379c26d9ed4c8e4e05a87cffae019586e0`,
      );
    });
  });
});
