# FC/USER-DASHBOARD

## Developemment Docker

```sh
docker-stack-legacy up ud
docker-stack-legacy dep-all
docker-stack-legacy start-all
# Browse to https://ud.docker.dev-franceconnect.fr/
```

## Login to the user-dashboard

> User : `test user for the login history`<br>
> Login : `test_TRACE_USER`<br>
> Password : `123`<br>

## Inject the business logs to Elasticsearch database

### Business logs from FranceConnect (legacy)

> After having started the core v1 stack

```sh
# remove FranceConnect legacy business logs
export CI=1; $FC_ROOT/fc-docker/docker-stack exec fc-core node --trace-warnings ./projects/fc/core/cli.js traces remove

# inject FranceConnect legacy business logs generated by the core v1
export CI=1; $FC_ROOT/fc-docker/docker-stack exec fc-core node --trace-warnings ./projects/fc/core/cli.js traces inject test_TRACE_USER '/var/log/fc-evt/event.log'

# generate default FranceConnect legacy business logs (today, 6 months minus 1 day ago, just after 6 months and 1 day ago)
export CI=1; $FC_ROOT/fc-docker/docker-stack exec fc-core node --trace-warnings ./projects/fc/core/cli.js traces generate test_TRACE_USER

# generate FranceConnect legacy business logs from specific template at specific dates
export CI=1; $FC_ROOT/fc-docker/docker-stack exec fc-core node --trace-warnings ./projects/fc/core/cli.js traces generate test_TRACE_USER '["fixtures/fsp1-fip1.mock.ejs"]' '["2022-06-21","2022-06-20"]'
```

### Business logs from FranceConnect+

> After having started the Elasticsearch container

```sh
# set the Elasticksearch environment variables
export Elasticsearch_TRACKS_INDEX="fc_tracks" && \
export Elasticsearch_NODES="[\"http://elasticsearch:9200\",\"https://elasticsearch:9200\"]" && \
export Elasticsearch_USERNAME="docker-stack" && \
export Elasticsearch_PASSWORD="docker-stack"

# remove the events from elasticsearch
node --trace-warnings ./populate-account-traces.script.js remove

# generate business logs for public/private sp with dates (today, 6 months minus 1 day ago, just after 6 months and 1 day ago)
node --trace-warnings ./populate-account-traces.script.js generate test_TRACE_USER

# generate business logs using the template `/tracks/fsp1-high/public_fip1-high.mock.ejs` for the dates `20 and 21 june 2022`
node --trace-warnings ./populate-account-traces.script.js generate test_TRACE_USER '["/tracks/fsp1-high/public_fip1-high.mock.ejs"]' '["2022-06-21","2022-06-20"]'
```

- [More details regarding the FC+ Tracks Injector](../../../quality/fcp/data/userdashboard/README.md)
