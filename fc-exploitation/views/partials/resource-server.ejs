<div class="form-group">
    <details>
        <summary id="open-custom-configuration">Section Fournisseur de données</summary>

        <div class="form-group row">
            <label class="col-2 col-form-label" for="introspection_signed_response_alg">introspection_signed_response_alg : </label>
            <div class="col-10">
                <select class="custom-select" name="introspection_signed_response_alg">
                    <option value="" <%= !messages.values || messages.values[0].introspection_signed_response_alg === null ? 'selected' : '' %>>[VIDE] - config FS par défaut</option>
                    <option value="HS256" <%= messages.values && messages.values[0].introspection_signed_response_alg === "HS256" ? 'selected' : '' %>>HS256 - config FD par défaut</option>
                    <option value="ES256" <%= messages.values && messages.values[0].introspection_signed_response_alg === "ES256" ? 'selected' : '' %>>ES256 - config FD</option>
                    <option value="RS256" <%= messages.values && messages.values[0].introspection_signed_response_alg === "RS256" ? 'selected' : '' %>>RS256 - config FD</option>
                </select>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-2 col-form-label" for="introspection_encrypted_response_alg">introspection_encrypted_response_alg :</label>
            <div class="col-10">
                <select class="custom-select" name="introspection_encrypted_response_alg">
                    <option value="" <%= !messages.values || messages.values[0].introspection_encrypted_response_alg === null ? 'selected' : '' %>>[VIDE] - config FS par défaut</option>
                    <option value="ECDH-ES" <%= messages.values && messages.values[0].introspection_encrypted_response_alg === "ECDH-ES" ? 'selected' : '' %>>ECDH-ES - config FD par défaut</option>
                    <option value="RSA-OAEP" <%= messages.values && messages.values[0].introspection_encrypted_response_alg === "RSA-OAEP" ? 'selected' : '' %>>RSA-OAEP - config FD</option>
                </select>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-2 col-form-label" for="introspection_encrypted_response_enc">introspection_encrypted_response_enc : </label>
            <div class="col-10">
                <select class="custom-select" name="introspection_encrypted_response_enc">
                    <option value="" <%= !messages.values || messages.values[0].introspection_encrypted_response_enc === null ? 'selected' : '' %>>[VIDE] - config FS par défaut</option>
                    <option value="A256GCM" <%= messages.values && messages.values[0].introspection_encrypted_response_enc === "A256GCM" ? 'selected' : '' %>>A256GCM - config FD par défaut</option>
                </select>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-2 col-form-label" for="response_types">response_types :</label>
            <div class="col-10">
                <textarea id="response_types" class="form-control" name="response_types" pattern=".*"><%= locals.messages.values && messages.values[0].response_types %></textarea>
                <p>
                <ul>
                    <li>"default" = configuration FS par défaut (laisse le champ vide pour laisser le core mettre la valeur par défaut)</li>
                    <li>"none" = configuration FD par défaut (remplit le champ avec un tableau vide pour désactiver les valeurs par défaut)</li>
                    <li>sinon, une entrée par ligne (ex : "code")</li>
                </ul>
                </p>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-2 col-form-label" for="grant_types">grant_types :</label>
            <div class="col-10">
                <textarea id="grant_types" class="form-control" name="grant_types" pattern=".*"><%= locals.messages.values && messages.values[0].grant_types %></textarea>
                <p>
                <ul>
                    <li>"default" = configuration FS par défaut (laisse le champ vide pour laisser le core mettre la valeur par défaut)</li>
                    <li>"none" = configuration FD par défaut (remplit le champ avec un tableau vide pour désactiver les valeurs par défaut)</li>
                    <li>sinon, une entrée par ligne (ex : "authorization_code" suivi de "refresh_token")</li>
                </ul>
                </p>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-2 col-form-label" for="jwks_uri">jwks_uri :</label>
            <div class="col-10">
                <input id="jwks_uri" type="text" class="form-control <%= locals.messages.errors && messages.errors[0].jwks_uri && 'is-invalid' %>" name="jwks_uri" value="<%= locals.messages.values && messages.values[0].jwks_uri %>">
                <div class="invalid-feedback">
                    <% if (locals.messages.errors && messages.errors[0].jwks_uri) { %>
                        <p>
                            <% messages.errors[0].jwks_uri.forEach((error) => { %>
                                <%= error %>
                                <br>
                            <% }) %>
                        </p>
                    <% } else { %>
                        Veuillez mettre une jwks_uri valide au format https://issuer.fr/jwks
                    <% } %>
                </div>
            </div>
        </div>
    </details>
</div>
