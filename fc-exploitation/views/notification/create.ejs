<!DOCTYPE html>
<html lang="fr">
  <head>
    <%- include('partials/head.ejs') -%>
  </head>
  <body>
  <%- include('partials/header.ejs') -%>
<div class="container-fluid notification">
  <div class="row">
    <div class="col-sm my-2">
      <h2 class="mb-4">Configuration d'une notification FC</h2>
      <form method="post" name="notification" action="<%= APP_ROOT %>/notification/create" data-init="validForm" novalidate>
        <input type="hidden" name="_csrf" value="<%= locals.csrfToken %>">
        <div class="form-group">
          <label for="message" class="mb-3">Contenu de la notification (200 caractères maximum)</label>
          <textarea class="form-control" 
            name="message" 
            id="message" 
            maxlength="200"
            cols="30" 
            rows="5" 
            pattern="^[A-Za-z0-9-\sàâéêèëîïôùç\'\.,!]+$"
            required><%= locals.messages.values && messages.values[0].message %></textarea>
        </div>
        
        <div class="row">
          <div class="col-sm my-1">
            <p class="mx-3">Début de la notification</p>
            <div class="form-inline">
              <div class="row">
                  <div class="col-sm">
                      <div class="row">
                        <div class="col-sm">
                          <label for="startDate" class="m-1">Date</label>
                          <input type="date" 
                            class="form-control mb-2 mr-sm-2" 
                            id="dateDebut" 
                            placeholder="YYYY-MM-DD" 
                            name="startDate"
                            data-init="validateInputDate"
                            value="<%= locals.messages.values && messages.values[0].startDate %>"
                            required>
                        </div>
                        <div class="col-sm">
                          <label for="startHour" class="m-1"> Heure</label>
                          <input type="time" 
                            class="form-control mb-2 mr-sm-2" 
                            id="startHour" 
                            placeholder="HH:mm" 
                            name="startHour"
                            data-init="validateInputHour"
                            pattern="[0-9]{2}:[0-9]{2}"
                            value="<%= locals.messages.values ? locals.messages.values && messages.values[0].startHour : "00:00" %>"
                            required>
                        </div>
                      </div>
                  </div>
              </div>
            </div>
          </div>
          <div class="col-sm my-1">
            <p class="mx-3">Fin de la notification</p>
            <div class="form-inline">
              <div class="row">
                <div class="col-sm">
                  <div class="row">
                    <div class="col-sm">
                      <label for="stopDate" class="m-1">Date</label>
                      <input type="date" 
                        class="form-control mb-2 mr-sm-2" 
                        id="dateFin"
                        placeholder="YYYY-MM-DD"
                        name="stopDate"
                        data-init="validateInputDate"
                        value="<%= locals.messages.values && messages.values[0].stopDate %>"
                        required>
                    </div>
                    <div class="col-sm">
                      <label for="stopHour" class="m-1"> Heure</label>
                      <input type="time" 
                        class="form-control mb-2 mr-sm-2" 
                        id="stopHour" 
                        placeholder="HH:mm" 
                        name="stopHour"
                        data-init="validateInputHour"
                        pattern="[0-9]{2}:[0-9]{2}"
                        value="<%= locals.messages.values ? locals.messages.values && messages.values[0].stopHour : "23:59" %>"
                        required>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xs-6 my-4">
          <p class="d-flex justify-content-center">Activer la notification</p>
          <div class="d-flex justify-content-center">
            <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" 
                  class="custom-control-input is-valid" 
                  id="activated" 
                  name="isActive" 
                  value="true"
                  checked 
                  required>
                <label class="custom-control-label" for="activated">oui</label>
              </div>
              <div class="custom-control custom-radio custom-control-inline">
                <input type="radio" 
                  class="custom-control-input is-valid" 
                  id="unactivated" 
                  name="isActive" 
                  value="false" 
                  required>
                <label class="custom-control-label" for="unactivated">non</label>
              </div>
          </div>   
        </div>

        <div class="d-flex justify-content-center">
          <label class="my-2" for="confirm-2FAuthentication">Code TOTP</label>
          <div class="col-lg-10">
            <input id="_totp" 
            type="text" 
            required 
            value="<%= locals.messages.values && messages.values[0]._totp %>"
            class="form-control <%= locals.messages.errors && messages.errors[0]._totp && 'is-invalid' %>" 
            name="_totp">
            <% if (locals.messages.errors && messages.errors[0]._totp) { %>
              <div class="invalid-feedback">
                <% locals.messages.errors[0]._totp.forEach((error) => { %>
                  <p><%= error %></p>
                <% }) %>
              </div>
            <% } %>
          </div>
        </div>

        <div class="d-flex justify-content-center mt-4">
          <button type="submit" id="submit-button" class="btn btn-primary">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>
</div>
</body>
</html>
