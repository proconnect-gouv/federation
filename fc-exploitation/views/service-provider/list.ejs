<!DOCTYPE html>
<html lang="fr">
<head>
  <% include partials/head.ejs %>
</head>
<body>
<% include partials/header.ejs %>
<div class="container">
  <div class="row">
    <div class="col-12">
      <p class="h2">Gestion des fournisseurs de service</p>
      <p id="fs-count"><i><%= activeServiceProvidersCount %> fournisseurs provisionnés et actifs</i></p>
      <% if (CURRENT_USER.roles.includes('admin')) { %>
        <a class="btn btn-primary mb-3" href="service-provider/create">Créer un fournisseur de service</a>
      <% } %>
      <table class="table table-hover table-light shadow-sm">
        <thead class="thead-light">
        <tr class="d-flex">
          <th scope="col" class="col-4">Nom du service</th>
          <th scope="col" class="col-4">Client ID</th>
          <th scope="col" class="col-2">Date de génération du secret</th>
          <th scope="col" class="col-1">Activé</th>
          <th scope="col" class="col-1">Actions</th>
        </tr>
        </thead>
        <tbody>
        <% serviceProviders.forEach(function(serviceProvider){ %>
          <tr id="fs" class="d-flex">
            <th scope="row" class="col-4 text-truncate"><%= serviceProvider.name %></th>
            <td class="col-4 text-truncate" title="<%= serviceProvider.clientId %>"><%= serviceProvider.clientId %></td>
            <td
              class="col-2 text-right"><%= serviceProvider.clientSecretCreatedAt && moment(serviceProvider.clientSecretCreatedAt).format('DD/MM/YYYY') %></td>
            <td class="text-center col-1">
              <i class="fa fa-toggle-<%= serviceProvider.active ? "on" : "off" %>"></i>
            </td>
            <td class="text-right col-1">
              <a href="#">
                <i class="fa fa-map-signs" aria-hidden="true" title="Ajouter une URL de callback"></i>
              </a>
              <a href="#">
                <i class="fa fa-trash" aria-hidden="true" title="Supprimer"></i>
              </a>
            </td>
          </tr>
        <% }) %>
        </tbody>
      </table>

    </div>
  </div>
</div>
</body>
</html>
