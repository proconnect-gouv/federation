<!DOCTYPE html>
<html lang="fr">
<head>
  <% include partials/head.ejs %>
</head>
<body>
<% include partials/header.ejs %>
<div class="container">
  <div class="row">
    <div class="col-12">
      <p class="h2">Ajouter un nouveau fournisseur de service</p>
    </div>
    <div class="card col-12">
      <% if (locals.globalError) { %>
        <div class="alert alert-danger mt-3">
          <%= globalError.code && ERROR_CODE_TRANSLATIONS[globalError.code] ? ERROR_CODE_TRANSLATIONS[globalError.code] : globalError %>
        </div>
      <% } %>
      <div class="card-body">
        <form method="POST" data-init="validForm" id="fs-form" name="fs-form"novalidate>
          <div class="form-group row">
            <label class="col-2 col-form-label" for="name">Nom : </label>
            <div class="col-10">
              <input id="name" type="'text" required
                     class="form-control <%= locals.errors && errors.name && 'is-invalid' %>" placeholder="Nom du fournisseur de service"
                     name="name" value="<%= locals.values && values.name %>" pattern="^[A-Za-z0-9-]+$"
                     required>
            
                <div class="invalid-feedback">
                <% if (locals.errors && errors.name) { %>
                  <% errors.name.forEach((error) => { %>
                    <p><%= error %></p>
                  <% }) %>
                  <% } else { %>
                    Veuillez mettre un nom valide ( Majuscule, minuscule, nombres et tiret d'union )
                    <% } %>
                </div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-2 col-form-label" for="redirectUri">Url de redirection : </label>
            <div class="col-10">
              <textarea id="redirectUri" required
                     class="form-control <%= locals.errors && errors.redirectUri && 'is-invalid' %>" placeholder="https://url-de-redirection.com"
                     name="redirectUri"
                     pattern="^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$"><%= locals.values && values.redirectUri %></textarea>
                     <div class="invalid-feedback">
                        <% if (locals.errors && errors.redirectUri) { %>
                          <% errors.redirectUri.forEach((error) => { %>
                            <p><%= error %></p>
                          <% }) %>
                          <% } else { %>
                            Veuillez mettre des urls valides ( Ex: https://url-de-redirection.com )
                            <% } %>
                        </div>
            </div>
          </div>


          <div class="form-group row">
            <label class="col-2 col-form-label" for="redirectUriLogout">Url de redirection de déconnexion : </label>
            <div class="col-10">
              <textarea id="redirectUriLogout" type="text" required
                     class="form-control <%= locals.errors && errors.redirectUriLogout && 'is-invalid' %>"
                     name="redirectUriLogout" placeholder="https://url-de-redirection/deconnexion.com"
                     pattern='^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$'><%= locals.values && values.redirectUriLogout %></textarea>
                     <div class="invalid-feedback">
                      <% if (locals.errors && errors.redirectUriLogout) { %>
                        <% errors.redirectUriLogout.forEach((error) => { %>
                          <p><%= error %></p>
                        <% }) %>
                        <% } else { %>
                          Veuillez mettre des urls valides ( Ex: https://url-de-redirection.com/logout )
                          <% } %>
                      </div>
            </div>
          </div>

          <div class="form-group row">
              <label class="col-2 col-form-label" for="site">Site : </label>
              <div class="col-10">
                <input id="site" type="text" required
                       class="form-control <%= locals.errors && errors.site && 'is-invalid' %>" placeholder="https://monsite.com"
                       name="site" value="<%= locals.values && values.site %>" pattern="^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$"
                       required>
                       <div class="invalid-feedback">
                        <% if (locals.errors && errors.site) { %>
                          <% errors.site.forEach((error) => { %>
                            <p><%= error %></p>
                          <% }) %>
                          <% } else { %>
                            Veuillez mettre une url valide ( Ex: https://toto.com/ )
                            <% } %>
                        </div>
              </div>
            </div>


            <div class="form-group row">
                <label class="col-2 col-form-label" for="emails">Email(s) de contact (une adresse mail par ligne)</label>
                <div class="col-10">
                <textarea required id="emails" class="form-control  <%= locals.errors && errors.emails && 'is-invalid' %>" 
                  name="emails" pattern='^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$'><%= locals.values && values.emails %></textarea>
                  <div class="invalid-feedback">
                    <% if (locals.errors && errors.emails) { %>
                      <% errors.emails.forEach((error) => { %>
                        <p><%= error %></p>
                      <% }) %>
                      <% } else { %>
                        Veuillez mettre des emails valides ( Ex: email@email.com )
                        <% } %>
                    </div>
                </div>
            </div>

            <div class="form-group row">
                <label class="col-2 col-form-label" for="ipAddresses">Plages d'adresses IP</label>
                <div class="col-10">
                <textarea required id="ipAddresses" class="form-control  <%= locals.errors && errors.ipAddresses && 'is-invalid' %>" 
                  name="ipAddresses"
                  pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"><%= locals.values && values.ipAddresses %></textarea>
                  <div class="invalid-feedback">
                    <% if (locals.errors && errors.ipAddresses) { %>
                      <% errors.ipAddresses.forEach((error) => { %>
                        <p><%= error %></p>
                      <% }) %>
                      <% } else { %>
                        Veuillez mettre des ips valides ( Ex: email@email.com )
                        <% } %>
                    </div>
                </div>
            </div>

            <div class="form-group row">


              <label class="col-2 col-form-label">FS activé en production : </label>
              <div class="form-group col-4 d-flex align-items-end">
                  <div class="custom-control custom-radio custom-control-inline">
                      <input
                          type="radio"
                          class="custom-control-input is-valid"
                          id="activated"
                          name="activateClient" 
                          value="activated"
                          disabled
                          required>
                      <label class="custom-control-label" for="activated">oui</label>
                  </div>

                  <div class="custom-control custom-radio custom-control-inline">
                    <input
                        type="radio"
                        class="custom-control-input is-valid"
                        id="unactivated"
                        name="activateClient" 
                        value="unactivated"
                        disabled
                        required>
                    <label class="custom-control-label" for="unactivated">non</label>
                </div>

              </div>


              <label class="col-2 col-form-label">Status du fournisseur de service  : </label>
              <div class="form-group col-4 d-flex align-items-end">
                <div class="custom-control custom-radio custom-control-inline">
                    <input
                        type="radio"
                        class="custom-control-input <%= locals.errors && errors.clientStatus && 'is-invalid' %>"
                        id="public"
                        name="clientStatus" 
                        value="public"
                        required>
                    <label class="custom-control-label" for="public">public</label>
                </div>

                <div class="custom-control custom-radio custom-control-inline">
                  <input
                      type="radio"
                      class="custom-control-input <%= locals.errors && errors.clientStatus && 'is-invalid' %>"
                      id="private"
                      name="clientStatus" 
                      value="private"
                      required>
                  <label class="custom-control-label" for="private">privé</label>
              </div>

              </div>


            </div>
            <input type="hidden" name="_csrf" value="<%= locals.csrfToken  %>">
          <button type="submit" class="btn btn-primary">Créer le fournisseur de service</button>
        </form>
      </div>
    </div>
  </div>
</div>
</body>
</html>
