<!DOCTYPE html>
<html lang="fr">
<head>
  <% include partials/head.ejs %>
</head>
<body>
<% include partials/header.ejs %>
<div class="container">
  <div class="row">
    <div class="col-12">
      <p class="h2">Ajouter un nouveau fournisseur de service</p>
    </div>
    <div class="card col-12">
      <% if (locals.globalError) { %>
        <div class="alert alert-danger mt-3">
          <%= globalError.code && ERROR_CODE_TRANSLATIONS[globalError.code] ? ERROR_CODE_TRANSLATIONS[globalError.code] : globalError %>
        </div>
      <% } %>
      <div class="card-body">
        <form method="POST" data-init="validForm" id="fs-form" name="fs-form"novalidate>
          <div class="form-group row">
            <label class="col-2 col-form-label" for="title">Titre : </label>
            <div class="col-10">
              <input id="title" type="'text" required
                     class="form-control <%= locals.errors && errors.title && 'is-invalid' %>" placeholder="Titre du fournisseur de service"
                     name="title" value="<%= locals.values && values.title %>" pattern="^[A-Za-z0-9- ]+$"
                     required>
            
                <div class="invalid-feedback">
                <% if (locals.errors && errors.title) { %>
                  <p>
                  <% errors.title.forEach((error) => { %>
                    <%= error %> 
                  <br>
                  <% }) %>
                </p>
                  <% } else { %>
                    Veuillez mettre un titre valide ( Majuscule, minuscule, nombres et trait d'union )
                    <% } %>
                </div>
            </div>
          </div>

          <div class="form-group row">
            <label class="col-2 col-form-label" for="title">Name : </label>
            <div class="col-10">
              <input id="title" type="'text" required
                     class="form-control <%= locals.errors && errors.name && 'is-invalid' %>" placeholder="Name du fournisseur de service"
                     name="name" value="<%= locals.values && values.name %>" pattern="^[A-Za-z0-9- ]+$"
                     required>
            
                <div class="invalid-feedback">
                <% if (locals.errors && errors.name) { %>
                  <p>
                  <% errors.name.forEach((error) => { %>
                    <%= error %> 
                  <br>
                  <% }) %>
                </p>
                  <% } else { %>
                    Veuillez mettre un nom valide ( Majuscule, minuscule, nombres et trait d'union )
                    <% } %>
                </div>
            </div>
          </div>
          <div class="form-group row">
            <label class="col-2 col-form-label" for="redirectUri">Url de redirection : </label>
            <div class="col-10">
              <textarea id="redirectUri" required
                     class="form-control <%= locals.errors && errors.redirectUri && 'is-invalid' %>" placeholder="https://url-de-redirection.com"
                     name="redirectUri"
                     pattern="^((https?:\/\/)?((([^\s\/$.?#]{1,})(\.[^\s\/$?#]{2,})*\.[a-z]{2,})|(([0-9]{1,3}\.){3}[0-9]{1,3})|localhost)(:[0-9]{4})?(\/[^\s\/$]+)*\/?)$"><%= locals.values && values.redirectUri %></textarea>
                     <div class="invalid-feedback">
                        <% if (locals.errors && errors.redirectUri) { %>
                          <p>
                            <% errors.redirectUri.forEach((error) => { %>
                              <%= error %> 
                            <br>
                            <% }) %>
                          </p>
                          <% } else { %>
                            Veuillez mettre une url valide ( Ex: https://toto.com/ )
                            <% } %>
                        </div>
            </div>
          </div>


          <div class="form-group row">
            <label class="col-2 col-form-label" for="redirectUriLogout">Url de redirection de déconnexion : </label>
            <div class="col-10">
              <textarea id="redirectUriLogout" type="text" required
                     class="form-control <%= locals.errors && errors.redirectUriLogout && 'is-invalid' %>"
                     name="redirectUriLogout" placeholder="https://url-de-redirection/deconnexion.com"
                     pattern="^((https?:\/\/)?((([^\s\/$.?#]{1,})(\.[^\s\/$?#]{2,})*\.[a-z]{2,})|(([0-9]{1,3}\.){3}[0-9]{1,3})|localhost)(:[0-9]{4})?(\/[^\s\/$]+)*\/?)$"><%= locals.values && values.redirectUriLogout %></textarea>
                     <div class="invalid-feedback">
                      <% if (locals.errors && errors.redirectUriLogout) { %>
                        <p>
                          <% errors.redirectUriLogout.forEach((error) => { %>
                            <%= error %> 
                          <br>
                          <% }) %>
                        </p>
                        <% } else { %>
                          Veuillez mettre une url valide ( Ex: https://toto.com/ )
                          <% } %>
                      </div>
            </div>
          </div>

          <div class="form-group row">
              <label class="col-2 col-form-label" for="site">Site : </label>
              <div class="col-10">
                <input id="site" type="text" required
                       class="form-control <%= locals.errors && errors.site && 'is-invalid' %>" placeholder="https://monsite.com"
                       name="site" value="<%= locals.values && values.site %>" 
                       pattern="^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$"
                       required>
                       <div class="invalid-feedback">
                        <% if (locals.errors && errors.site) { %>
                          <p>
                            <% errors.site.forEach((error) => { %>
                              <%= error %> 
                            <br>
                            <% }) %>
                          </p>
                          <% } else { %>
                            Veuillez mettre une url valide ( Ex: https://toto.com/ )
                            <% } %>
                        </div>
              </div>
            </div>


            <div class="form-group row">
                <label class="col-2 col-form-label" for="emails">Email(s) de contact (un par ligne)</label>
                <div class="col-10">
                <textarea required id="emails" class="form-control  <%= locals.errors && errors.emails && 'is-invalid' %>"  placeholder="email@email.com"
                  name="emails" pattern="^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$"><%= locals.values && values.emails %></textarea>
                  <div class="invalid-feedback">
                    <% if (locals.errors && errors.emails) { %>
                      <p>
                        <% errors.emails.forEach((error) => { %>
                          <%= error %> 
                        <br>
                        <% }) %>
                      </p>
                      <% } else { %>
                        Veuillez mettre des emails valides ( Ex: email@email.com )
                        <% } %>
                    </div>
                </div>
            </div>

            <div class="form-group row">
                <label class="col-2 col-form-label" for="ipAddresses">Plages d'adresses IP (une par ligne)</label>
                <div class="col-10">
                <textarea required id="ipAddresses" class="form-control  <%= locals.errors && errors.ipAddresses && 'is-invalid' %>" placeholder="1.1.1.1"
                  name="ipAddresses"
                  pattern="^((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])(?::\d{0,5})?$"><%= locals.values && values.ipAddresses %></textarea>
                  <div class="invalid-feedback">
                    <% if (locals.errors && errors.ipAddresses) { %>
                      <p>
                        <% errors.ipAddresses.forEach((error) => { %>
                          <%= error %> 
                        <br>
                        <% }) %>
                      </p>
                      <% } else { %>
                        Veuillez mettre des ips valides ( Ex: 1.1.1.1 )
                        <% } %>
                    </div>
                </div>
            </div>

            <div class="form-group row">


              <label class="col-2 col-form-label">Activé : </label>
              <div class="form-group col-4 d-flex align-items-end">
                  <div class="custom-control custom-radio custom-control-inline">
                      <input
                          type="radio"
                          class="custom-control-input is-valid"
                          id="activated"
                          name="activateClient" 
                          value=true
                          disabled
                          required>
                      <label class="custom-control-label" for="activated">oui</label>
                  </div>

                  <div class="custom-control custom-radio custom-control-inline">
                    <input
                        type="radio"
                        class="custom-control-input is-valid"
                        id="unactivated"
                        name="activateClient" 
                        value=false
                        checked
                        required>
                    <label class="custom-control-label" for="unactivated" >non</label>
                </div>
              </div>


              <label class="col-2 col-form-label">Status du fournisseur de service  : </label>
              <div class="form-group col-4 d-flex align-items-end">
                <div class="custom-control custom-radio custom-control-inline">
                    <input
                        type="radio"
                        class="custom-control-input <%= locals.errors && errors.clientStatus && 'is-invalid' %>"
                        id="public"
                        name="clientStatus" 
                        value="public"
                        required>
                    <label class="custom-control-label" for="public">public</label>
                </div>

                <div class="custom-control custom-radio custom-control-inline">
                  <input
                      type="radio"
                      class="custom-control-input <%= locals.errors && errors.clientStatus && 'is-invalid' %>"
                      id="private"
                      name="clientStatus" 
                      value="private"
                      required>
                  <label class="custom-control-label" for="private">privé</label>
              </div>
              </div>


            </div>
            <input type="hidden" name="_csrf" value="<%= locals.csrfToken  %>">
          <button type="submit" class="btn btn-primary">Créer le fournisseur de service</button>
        </form>
      </div>
    </div>
  </div>
</div>
</body>
</html>
