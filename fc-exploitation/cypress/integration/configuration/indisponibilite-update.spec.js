import { BASE_URL, USER_OPERATOR, USER_PASS } from '../constants.util';
import { login } from '../login.util';
import {
  useMenuToIndisponibilitePage,
  validFilledForm,
  invalidTotpFilledForm,
  invalidDateRangeFilledForm,
  invalidMessageFormFilledForm,
  emptyForm
} from './indisponibiite-update.util';


describe(' Modify "indisponibilité" message', () => {
  beforeEach(() => {
    login(USER_OPERATOR, USER_PASS);
    useMenuToIndisponibilitePage();
  });

  describe('Should be successful', () => {
    it('if when click to configuration/indisponibilite button, page show a form', () => {
      cy.get(`form`).should('be.visible');
    });

    it('if a valid form is submit', () => {
      validFilledForm();
      cy.get('button[type="submit"]').click();

      cy.url().should('eq', `${BASE_URL}/configuration/indisponibilite`);
      cy.contains(`Message d'indisponibilité activé avec succès !`);
    });
  });

  describe('Should fail', () => {
    it('if the TOTP field is empty', () => {
      invalidTotpFilledForm();

      cy.url().should('eq', `${BASE_URL}/configuration/indisponibilite`);
      cy.contains(`Le TOTP saisi n'est pas valide`);
    });
  });
});
