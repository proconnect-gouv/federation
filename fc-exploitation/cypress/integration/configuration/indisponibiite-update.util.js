import * as otplib from 'otplib';
import { SECRET_TOTP } from '../constants.util';

function generateTotp() {
  return otplib.authenticator.generate(SECRET_TOTP);
}

export function validFilledForm() {
  cy.get('textarea[name="message"]').clear().type('Nouveau message');
  cy.get('input[name="dateDebut"]').clear().type('2019-09-12');
  cy.get('input[name="dateFin"]').clear().type('2019-09-12');
  cy.get('input[name="heureDebut"]').clear().type('10:00');
  cy.get('input[name="heureFin"]').clear().type('11:00');
  cy.get('input[name="emails"]').clear().type('seldon@fondation.com');
  cy.get('input[name="activateMessage"]').uncheck().check({ force: true });
  cy.get('input[name="_totp"]').clear().type(generateTotp());
}

export function invalidTotpFilledForm() {
  cy.get('textarea[name="message"]').clear().type('Nouveau message');
  cy.get('input[name="dateDebut"]').clear().type('2019-09-12');
  cy.get('input[name="dateFin"]').clear().type('2019-09-12');
  cy.get('input[name="heureDebut"]').clear().type('10:00');
  cy.get('input[name="heureFin"]').clear().type('11:00');
  cy.get('input[name="emails"]').clear().type('seldon@fondation.com');
  cy.get('input[name="activateMessage"]').uncheck().check({ force: true });
  cy.get('input[name="_totp"]').clear().type('false totp token');
  cy.get('button[type="submit"]').click();
}

export function invalidMessageFormFilledForm() {
  cy.get('input[name="dateDebut"]').clear().type('2019-09-13');
  cy.get('input[name="dateFin"]').clear().type('2019-09-12');
  cy.get('input[name="heureDebut"]').clear().type('10:00');
  cy.get('input[name="heureFin"]').clear().type('11:00');
  cy.get('input[name="emails"]').clear().type('seldon@fondation.com');
  cy.get('input[name="activateMessage"]').uncheck().check({ force: true });
  cy.get('input[name="_totp"]').clear().type(generateTotp());
  cy.get('button[type="submit"]').click();
}

export function emptyForm() {
  cy.get('button[type="submit"]').click();
}

export function useMenuToIndisponibilitePage() {
  cy.get('#dropdownMenuButton').click();
  cy.get('#indisponibilite').click();
}
