import { IsNotEmpty, IsString, Matches, IsEmpty, IsUrl } from 'class-validator';
import { Transform, Type } from 'class-transformer';
import { SortStringDTO } from './SortString.dto';

export class CreateServiceProviderDto {
  @Matches(/^[A-Za-z0-9-]+$/, { message: 'Veuillez renseigner un nom valide' })
  @IsNotEmpty({
    message: `L'url de redirection du fournisseur de service doit être renseigné`,
  })
  @IsString()
  readonly name: string;

  @Type(() => SortStringDTO)
  @Transform(value => SortStringDTO.toArray(value), {
    toClassOnly: true,
  })
  readonly redirectUri: SortStringDTO;

  @Type(() => SortStringDTO)
  @Transform(value => SortStringDTO.toArray(value), {
    toClassOnly: true,
  })
  readonly redirectUriLogout: SortStringDTO;

  @IsNotEmpty({
    message: `Veuillez renseigner le site du fournisseur de service`,
  })
  @IsString()
  @IsUrl()
  readonly site: string;

  @Type(() => SortStringDTO)
  @Transform(value => SortStringDTO.toArray(value), {
    toClassOnly: true,
  })
  readonly emails: SortStringDTO;

  @Type(() => SortStringDTO)
  @Transform(value => SortStringDTO.toArray(value), {
    toClassOnly: true,
  })
  readonly ipAddresses: SortStringDTO;

  readonly activateClient: string;

  readonly clientStatus: string;
}
