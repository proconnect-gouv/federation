import { Controller, Get, Render } from '@nestjs/common';
import { IdentityProvider } from './identity-provider.entity';
import { Repository } from 'typeorm';
import { InjectRepository } from '@nestjs/typeorm';
import { Roles } from '@fc/shared/authentication/decorator/roles.decorator';
import { UserRole } from '@fc/shared/user/roles.enum';

@Controller()
export class IdentityProviderController {
  constructor(
    @InjectRepository(IdentityProvider, 'fc-mongo')
    private readonly identityProviderRepository: Repository<IdentityProvider>,
  ) {}

  @Get('identity-provider')
  @Roles(UserRole.OPERATOR)
  @Render('identity-provider/list')
  async list() {
    const identityProviders = await this.identityProviderRepository.find();
    return {
      identityProviders,
    };
  }
}
