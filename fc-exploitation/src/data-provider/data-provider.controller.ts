import { Controller, Get, Render } from '@nestjs/common';
import { Roles } from '@fc/shared/authentication/decorator/roles.decorator';
import { UserRole } from '@fc/shared/user/roles.enum';
import { DataProviderService } from './data-provider.service';
import { ScopeLabels } from './scope-labels.entity';

@Controller('data-provider')
export class DataProviderController {
  constructor(private readonly dataProviderService: DataProviderService) {}

  @Get('labels-management')
  @Roles(UserRole.OPERATOR)
  @Render('data-provider/labels-management/list')
  async list() {
    const scopesAndLabelsList = await this.dataProviderService.getScopesAndLabels();
    const scopeLabelsCount = await this.dataProviderService.getScopeAndLabelCount();

    return {
      scopeLabelsCount,
      scopesAndLabelsList,
    };
  }
}
