stages:
  - install
  - test
  - run

global-install:
  image: node:12.15.0
  stage: install
  script:
    - yarn install
    - yarn lint
    - yarn test --coverage
    - ./node-scripts/coverage.sh
  coverage: '/Global coverage is: \[([\d\.]+)%\]/'
  artifacts:
    paths:
      - node_modules
      - fc-exploitation/node_modules
      - fc-stats/node_modules
      - fc-support/node_modules
      - fc-workers/node_modules
      - shared/node_modules

include:
  - '/shared/.gitlab-ci.yml'
  - '/fc-exploitation/.gitlab-ci.yml'
  - '/fc-stats/.gitlab-ci.yml'
  - '/fc-workers/.gitlab-ci.yml'
  - '/fc-support/.gitlab-ci.yml'
