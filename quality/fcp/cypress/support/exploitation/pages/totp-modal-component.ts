import { ChainableElement } from '../../common/types';
import { OperatorUser } from '../helpers';

export default class TotpModal {
  getSuccessButton(): ChainableElement {
    return cy.get('button.btn-yes');
  }

  getTotpInput(): ChainableElement {
    return cy.get('#totpModal');
  }

  submitTotp(user: OperatorUser): void {
    this.getTotpInput()
      .then(() => user.wrapTotp())
      // clearThenType() command doesn't work on the idp settings modal
      // Force Cypress to accept chaining clear and type commands
      // eslint-disable-next-line cypress/unsafe-to-chain-command
      .then((token: string) => this.getTotpInput().clear().type(token));
    this.getSuccessButton().click();
  }
}
