import { When } from 'cypress-cucumber-preprocessor/steps';

import { OperatorUser } from '../helpers';
import ExploitIdpFormPage from '../pages/exploit-idp-form-page';

const exploitIdpFormPage = new ExploitIdpFormPage();

When(
  "j'entre les valeurs par défaut pour mon fournisseur d'identité",
  function () {
    exploitIdpFormPage.fillDefaultValues(this.identityProviderConfig);
  },
);

When(
  /^j'entre "([^"]+)" dans le champ "([^"]+)" du formulaire de (?:création|modification) de FI$/,
  function (value: string, key: string) {
    exploitIdpFormPage.fillValue(key, value);
    this.identityProviderConfig[key] = value;
  },
);

When(
  /^je valide le formulaire de (?:création|modification) de FI$/,
  function () {
    const user: OperatorUser = this.operatorUser;
    exploitIdpFormPage.validateForm(user);
  },
);
