import { Then, When } from 'cypress-cucumber-preprocessor/steps';

import { OperatorUser } from '../helpers';
import ExploitIdpListPage from '../pages/exploit-idp-list-page';

const exploitIdpListPage = new ExploitIdpListPage();

When('je clique sur le bouton de création de FI', function () {
  exploitIdpListPage.getCreateIdpButton().click();
});

When(
  'je clique sur le bouton de modification de FI {string}',
  function (idpName: string) {
    exploitIdpListPage.navigateToUpdateIdpPage(idpName, this.idpConfig);
  },
);

When(/^je supprime le fournisseur d'identité "([^"]*)"$/, function (idpName) {
  const user: OperatorUser = this.operatorUser;
  exploitIdpListPage.deleteIdp(idpName, user);
});

Then('le message de confirmation de création de FI est affiché', function () {
  exploitIdpListPage.checkConfirmCreateMessage(this.idpConfig.name);
});

When(
  'le message de confirmation de suppression du FI {string} est affiché',
  (idpName: string) => {
    exploitIdpListPage.checkConfirmDeleteMessage(idpName);
  },
);

Then(
  'le message de confirmation de modification de FI est affiché',
  function () {
    exploitIdpListPage.checkConfirmUpdateMessage(this.idpConfig.title);
  },
);
