import { Then, When } from 'cypress-cucumber-preprocessor/steps';

import { OperatorUser } from '../helpers';
import ExploitIdpListPage from '../pages/exploit-idp-list-page';

const exploitIdpListPage = new ExploitIdpListPage();

When('je clique sur le bouton de création de FI', function () {
  exploitIdpListPage.createIdpButton.click();
});

When(
  'je clique sur le bouton de modification de FI {string}',
  function (idpName: string) {
    exploitIdpListPage.navigateToUpdateIdpPage(
      idpName,
      this.identityProviderConfig,
    );
  },
);

When("je supprime le fournisseur d'identité {string}", function (idpId) {
  const user: OperatorUser = this.operatorUser;
  exploitIdpListPage.deleteIdp(idpId, user);
});

Then('le message de confirmation de création de FI est affiché', function () {
  exploitIdpListPage.checkConfirmCreateMessage(
    this.identityProviderConfig.name,
  );
});

When(
  'le message de confirmation de suppression du FI {string} est affiché',
  (idpName: string) => {
    exploitIdpListPage.checkConfirmDeleteMessage(idpName);
  },
);

Then(
  'le message de confirmation de modification de FI est affiché',
  function () {
    exploitIdpListPage.checkConfirmUpdateMessage(
      this.identityProviderConfig.title,
    );
  },
);
