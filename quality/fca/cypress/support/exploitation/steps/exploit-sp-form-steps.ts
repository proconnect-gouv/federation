import { Then, When } from '@badeball/cypress-cucumber-preprocessor';

import ExploitSpFormPage from '../pages/exploit-sp-form-page';

const exploitSpFormPage = new ExploitSpFormPage();

When(
  "j'entre les valeurs par défaut pour mon fournisseur de service",
  function () {
    exploitSpFormPage.fillDefaultValues(this.spConfig);
  },
);

When(
  /^j'entre "([^"]*)" dans le champ "([^"]+)" du formulaire de (?:création|modification) de FS$/,
  function (value: string, key: string) {
    exploitSpFormPage.fillValue(key, value);
    // Update SP config
    this.spConfig = {
      ...this.spConfig,
      [key]: value,
    };
  },
);

Then(
  /^le champ "([^"]+)" contient "([^"]*)" dans le formulaire de (?:création|modification) de FS$/,
  function (name: string, value: string) {
    exploitSpFormPage.checkHasValue(name, value);
  },
);

Then(
  /^les cases à cocher des FI sont (activées|désactivées) dans le formulaire de (?:création|modification) de FS$/,
  function (text: string) {
    const isDisabled = text === 'désactivées';
    exploitSpFormPage.checkIsIdpFilterListDisabled(isDisabled);
  },
);

Then(
  /^la liste "([^"]+)" contient "([^"]*)" dans le formulaire de (?:création|modification) de FS$/,
  function (name: string, value: string) {
    exploitSpFormPage.checkHasListSelectedOptionLabel(name, value);
  },
);

When(
  /^je valide le formulaire de (?:création|modification) de FS$/,
  function () {
    exploitSpFormPage.validateForm(this.operatorUser);
  },
);
