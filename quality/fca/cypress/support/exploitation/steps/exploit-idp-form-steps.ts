import { Then, When } from '@badeball/cypress-cucumber-preprocessor';

import { getDefaultIdentityProviderConfig } from '../../common/helpers';
import ExploitIdpFormPage from '../pages/exploit-idp-form-page';

const exploitIdpFormPage = new ExploitIdpFormPage();

When(
  "j'entre les valeurs par défaut pour mon fournisseur d'identité",
  function () {
    exploitIdpFormPage.fillDefaultValues(getDefaultIdentityProviderConfig());
  },
);

When(
  /^j'entre "([^"]+)" dans le champ "([^"]+)" du formulaire de (?:création|modification) de FI$/,
  function (value: string, key: string) {
    exploitIdpFormPage.fillValue(key, value);
  },
);

When(
  /^je mets à vide le champ "([^"]+)" du formulaire de (?:création|modification) de FI$/,
  function (key: string) {
    exploitIdpFormPage.fillValue(key, '');
  },
);

Then(
  /^le champ "([^"]+)" est rejeté avec le message "([^"]+)"$/,
  function (fieldName: string, message: string) {
    exploitIdpFormPage.checkFieldError(fieldName, message);
  },
);

When(
  /^je valide le formulaire de (?:création|modification) de FI$/,
  function () {
    exploitIdpFormPage.validateForm(this.operatorUser);
  },
);
