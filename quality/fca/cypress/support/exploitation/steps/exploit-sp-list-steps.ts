import { Then, When } from '@badeball/cypress-cucumber-preprocessor';

import ExploitSpListPage from '../pages/exploit-sp-list-page';

const exploitSpListPage = new ExploitSpListPage();

When('je clique sur le bouton de création de FS', function () {
  exploitSpListPage.getCreateSpButton().click();
});

When(
  'je clique sur le bouton de modification du FS {string}',
  function (spName: string) {
    exploitSpListPage.navigateToUpdateSpPage(spName);
    // Update SP config
    this.spConfig = {
      ...this.spConfig,
      name: spName,
    };
  },
);

When('je clique sur le bouton de modification du FS', function () {
  const { name: spName } = this.serviceProvider;
  exploitSpListPage.navigateToUpdateSpPage(spName);
  // Update SP config
  this.spConfig = {
    ...this.spConfig,
    name: spName,
  };
});

When(
  /^je supprime le fournisseur de service "([^"]*)"$/,
  function (spName: string) {
    exploitSpListPage.deleteSp(spName, this.operatorUser);
  },
);

When(
  /^je supprime les fournisseurs de service commençant par "([^"]*)"$/,
  function (spName: string) {
    exploitSpListPage.deleteAllSpStartingWith(spName, this.operatorUser);
  },
);

Then('le message de confirmation de création de FS est affiché', function () {
  const { name: spName } = this.spConfig;
  exploitSpListPage.checkConfirmCreateMessage(spName);
});

When(
  'le message de confirmation de suppression du FS {string} est affiché',
  (spName: string) => {
    exploitSpListPage.checkConfirmDeleteMessage(spName);
  },
);

Then(
  'le message de confirmation de modification de FS est affiché',
  function () {
    const { name: spName } = this.spConfig;
    exploitSpListPage.checkConfirmUpdateMessage(spName);
  },
);
